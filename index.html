<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Vehicle World</title>

<style>
body{
margin:0;font-family:Arial;
background:linear-gradient(120deg,#0f3d2e,#145a32);
height:100vh;display:flex;justify-content:center;align-items:center;
}

.card{background:#fff;padding:30px;border-radius:16px;width:340px;text-align:center}
input,button{width:100%;padding:12px;margin:8px 0;border-radius:10px;border:1px solid #ccc}
button{background:#145a32;color:white;border:none;cursor:pointer}

.links{display:flex;justify-content:space-between;font-size:14px;color:#145a32;cursor:pointer}
#msg,#mmsg{color:red;font-size:14px}

#main{display:none;color:white;text-align:center}
.mainBox{background:#000c;padding:25px;border-radius:18px;width:350px}

.wallet{position:fixed;top:12px;right:12px;background:white;color:black;padding:10px;border-radius:12px;font-weight:bold;cursor:pointer}

.history{font-size:13px;margin-top:12px;text-align:left}
</style>
</head>

<body>

<div id="login" class="card">
<h2>VEHICLE WORLD</h2>
<input id="mobile" placeholder="Mobile Number">
<input id="pass" type="password" placeholder="Password">
<button onclick="loginUser()">Login</button>
<div class="links">
<span onclick="signup()">Signup</span>
<span onclick="forgot()">Forgot?</span>
</div>
<p id="msg"></p>
</div>

<div id="main">

<div class="wallet" onclick="showRecharge()">ðŸ’¼ â‚¹<span id="bal">0</span></div>

<div class="mainBox">
<h3>ðŸš— Enter Vehicle Number</h3>
<input id="vehicle">
<button onclick="submitRC()">Submit (â‚¹120)</button>
<p id="mmsg"></p>

<h4>History</h4>
<div id="history" class="history"></div>
</div>

<div id="recharge" class="mainBox" style="margin-top:15px;display:none">
<h4>Recharge Wallet</h4>
<img width="200" src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=upi://pay?pa=bestinsurance@upi&pn=WalletRecharge">
<input id="addAmount" placeholder="Enter amount">
<button onclick="addMoney()">Add Money</button>
</div>

</div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
const firebaseConfig = {
 apiKey:"AIzaSyDfj6AmE8EKOWkSDJvTMCBTEdQf7GVv_UI",
 authDomain:"rcpdf-4fdb8.firebaseapp.com",
 databaseURL:"https://rcpdf-4fdb8-default-rtdb.firebaseio.com",
 projectId:"rcpdf-4fdb8",
 storageBucket:"rcpdf-4fdb8.firebasestorage.app",
 appId:"1:98705276911:web:aa50a8aaa85d514f65401a"
};

firebase.initializeApp(firebaseConfig);
const db=firebase.database();

let user="",wallet=0;

const bot="8138238341:AAFlgSY3OGo5oOfa-IbZ9DxdgrmAeVE525E";
const chat="5600045707";

function signup(){
 if(!mobile.value||!pass.value)return msg("Fill fields");
 db.ref("users/"+mobile.value).set({password:pass.value,wallet:0});
 msg("Signup success");
}

function loginUser(){
 db.ref("users/"+mobile.value).get().then(s=>{
 if(!s.exists()) return msg("User not found");
 if(s.val().password!==pass.value) return msg("Wrong password");

 user=mobile.value;
 wallet=s.val().wallet||0;
 bal.innerText=wallet;

 login.style.display="none";
 main.style.display="block";
 loadHistory();
 });
}

function forgot(){
 db.ref("users/"+mobile.value).get().then(s=>{
 if(!s.exists()) msg("Not found");
 else msg("Password: "+s.val().password);
 });
}

function msg(t){msgEl=document.getElementById("msg");msgEl.innerText=t}

function submitRC(){
 if(wallet<120) return mmsg.innerText="Low balance";

 wallet-=120;
 bal.innerText=wallet;
 db.ref("users/"+user+"/wallet").set(wallet);

 let tx={type:"RC Request",amount:-120,time:Date.now()};
 db.ref("users/"+user+"/history").push(tx);

 fetch(`https://api.telegram.org/bot${bot}/sendMessage`,{
 method:"POST",
 headers:{"Content-Type":"application/json"},
 body:JSON.stringify({
  chat_id:chat,
  text:`ðŸš— RC REQUEST\nVehicle: ${vehicle.value}\nUser: ${user}`
 })
});

 mmsg.innerText="Request sent & â‚¹120 deducted!";
 loadHistory();
}

function showRecharge(){
 recharge.style.display = recharge.style.display==="none"?"block":"none";
}

function addMoney(){
 let amt=parseInt(addAmount.value);
 if(!amt) return;

 wallet+=amt;
 bal.innerText=wallet;
 db.ref("users/"+user+"/wallet").set(wallet);

 db.ref("users/"+user+"/history").push({
  type:"Recharge",
  amount:amt,
  time:Date.now()
 });

 loadHistory();
 addAmount.value="";
}

function loadHistory(){
 db.ref("users/"+user+"/history").on("value",s=>{
 let out="";
 s.forEach(r=>{
 let d=r.val();
 out+=`${new Date(d.time).toLocaleString()} â€” ${d.type} : â‚¹${d.amount}<br>`;
 });
 history.innerHTML=out || "No transactions yet";
});
}
</script>

</body>
</html>