<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>RC PDF Secure Login</title>
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body{
font-family:Arial;
background:#0f172a;
color:white;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}

.box{
background:#000c;
padding:25px;
border-radius:16px;
width:320px;
text-align:center;
}

input,button{
width:100%;
padding:10px;
margin-top:10px;
border-radius:8px;
border:none;
}

button{
background:#00ffd5;
font-weight:bold;
cursor:pointer;
}

#userName{
position:fixed;
top:10px;
right:10px;
background:white;
color:black;
padding:6px 12px;
border-radius:8px;
display:none;
}

#logoutBtn{
position:fixed;
top:45px;
right:10px;
background:red;
color:white;
padding:6px 12px;
border-radius:8px;
display:none;
}

.hidden{display:none}
</style>
</head>

<body>

<div id="userName"></div>
<button id="logoutBtn" onclick="logout()">Logout</button>

<div class="box" id="authBox">

<h3 id="title">Login</h3>

<input id="name" placeholder="Name" class="hidden">
<input id="email" placeholder="Gmail address">
<input id="pass" type="password" placeholder="Password">

<button onclick="auth()">Continue</button>

<p onclick="toggleMode()" style="cursor:pointer;color:#00ffd5">Switch Login / Signup</p>
<p onclick="sendOTP()" style="cursor:pointer;color:orange">Forgot Password?</p>

<p id="msg"></p>

</div>

<div class="box hidden" id="otpBox">
<h3>Verify OTP</h3>
<input id="otpInput" placeholder="Enter OTP">
<input id="newPass" placeholder="New Password">
<button onclick="verifyOTP()">Confirm</button>
</div>

<script>
emailjs.init("eRTexjroiPjM9miek");

let users=JSON.parse(localStorage.getItem("users")||"{}");
let mode="login";
let sentOTP="", otpEmail="";

function save(){
localStorage.setItem("users",JSON.stringify(users));
}

function toggleMode(){
mode=mode==="login"?"signup":"login";
title.innerText=mode==="signup"?"Signup":"Login";
name.classList.toggle("hidden");
}

function auth(){
let e=email.value.trim();
let p=pass.value.trim();
let n=name.value.trim();

if(mode==="signup"){
if(!e||!p||!n) return msg.innerText="Fill all fields";
users[e]={name:n,password:p};
save();
msg.innerText="Signup successful. Login now.";
toggleMode();
return;
}

if(!users[e]) return msg.innerText="Account not found";
if(users[e].password!==p) return msg.innerText="Wrong password";

localStorage.setItem("loggedUser",e);
showUser();
authBox.classList.add("hidden");
}

function showUser(){
let e=localStorage.getItem("loggedUser");
userName.innerText="ðŸ‘¤ "+users[e].name;
userName.style.display="block";
logoutBtn.style.display="block";
}

function logout(){
localStorage.removeItem("loggedUser");
location.reload();
}

/* OTP SYSTEM */

function sendOTP(){
let e=email.value.trim();
if(!users[e]) return msg.innerText="Email not registered";

sentOTP=Math.floor(100000+Math.random()*900000).toString();
otpEmail=e;

emailjs.send("service_h04mrbw","template_g84p4hi",{
email:e,
passcode:sentOTP
});

authBox.classList.add("hidden");
otpBox.classList.remove("hidden");
}

function verifyOTP(){
if(otpInput.value!==sentOTP) return alert("Invalid OTP");

users[otpEmail].password=newPass.value;
save();

alert("Password reset successful!");
location.reload();
}

if(localStorage.getItem("loggedUser")) showUser();
</script>

</body>
</html>